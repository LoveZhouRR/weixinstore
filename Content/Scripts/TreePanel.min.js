(function(){window["undefined"]=window["undefined"];String.isInstance=function(a){return(typeof(a)==="string")};String.isEmpty=function(a){return(typeof(a)==="undefined"||a===null||(a.length===0))};String.isNotEmpty=function(a){return(!String.isEmpty(a))};String.prototype.trim=function(){return this.replace(/(^[\s]*)|([\s]*$)/g,"")};String.prototype.getAttribute=function(a){var b=new RegExp("(^|;|\\s)"+a+"\\s*:\\s*([^;]*)(\\s|;|$)","i");if(b.test(this)){return RegExp.$2.replace(/[\x0f]/g,";")}return null};String.prototype.cnLength=function(){return((this.replace(/[^x00-xFF]/g,"**")).length)};Array.isInstance=function(a){return Object.prototype.toString.call(a)==="[object Array]"};Array.prototype.add=function(a){this.push(a)};Array.prototype.indexOf=function(c){for(var a=0,b=this.length;a<b;a=a+1){if(this[a]!=null&&typeof(this[a].equals)=="function"&&this[a].equals(c)){return a}if(this[a]==c){return a}}return -1};Array.prototype.equals=function(a){if(this==a){return true}if(!Array.isInstance(a)){return false}if(this.length!=a.length){return false}for(var b=0,c=this.length;b<c;b=b+1){var d=this[b];var e=a[b];if(d!=e){if(!(typeof(d.equals)=="function"&&d.equals(e))){return false}}}return true};Array.prototype.remove=function(b){var a=this.indexOf(b);if(a!=-1){this.splice(a,1);return true}else{return false}};Array.prototype.contains=function(a){return this.indexOf(a)!=-1};Array.prototype.containsAll=function(c){if(this==c){return true}for(var a=0;a<c.length;a=a+1){var b=c[a];if(!this.contains(b)){return false}}return true};Date.isInstance=function(a){return(Object.prototype.toString.call(a)==="[object Date]")};Function.isInstance=function(a){return Object.prototype.toString.call(a)==="[object Function]"};Number.isInstance=function(a){return Object.prototype.toString.call(a)==="[object Number]"};Boolean.isInstance=function(a){return Object.prototype.toString.call(a)==="[object Boolean]"}})();getUniqueID=function(){return("_"+(new Date().getTime())+"_"+parseInt(Math.random()*10000))};TreePanel=function(a){this.nodeHash={};this.root=null;this._id=getUniqueID();this.iconPath="/Content/Scripts/img/";this.clickListeners=[];this.element=document.createElement("div");this.element.className="TreePanel";this.container=null;this.focusNode=null;this.on=this.addListener;this.initialize.apply(this,arguments)};TreePanel.prototype={initialize:function(a){var e=a.renderTo;this.container=(String.isInstance(e)?document.getElementById(e):e)||document.body;var b=a.handler;if(Function.isInstance(b)){this.addListener("click",b)}var c=a.iconPath;if(String.isInstance(c)){this.iconPath=c}var d=new TreeNode(a.root);this.setRootNode(d)},pathSeparator:"/",getRootNode:function(){return this.root},setRootNode:function(a){this.root=a;a.ownerTree=this;this.registerNode(a);a.cascade((function(b){this.registerNode(b)}),this)},getNodeById:function(a){return this.nodeHash[a]},registerNode:function(a){this.nodeHash[a.id]=a},unregisterNode:function(a){delete this.nodeHash[a.id]},render:function(){this.element.innerHTML="";this.root.render();if(this.container){this.container.appendChild(this.element)}this.initEvent()},getIcon:function(a){return this.iconPath+this.icon[a]},getIconByType:function(a){return a},initEvent:function(){var a=this;this.element.onclick=function(d){d=d||window.event;var c=(d.srcElement||d.target);var b=c._type_;if(typeof(b)==="undefined"){return}c=c.parentNode||c.parentElement;if(b=="clip"){if(c.indexId!=null){var f=a.nodeHash[c.indexId];if(f.isExpand){f.collapse()}else{f.expand()}}}else{if(b=="icon"||b=="text"){f=a.nodeHash[c.indexId];for(var e=0;e<a.clickListeners.length;e++){a.clickListeners[e](f)}a.setFocusNode(f)}else{if(b=="checked"){f=a.nodeHash[c.indexId];f.onCheck()}}}}},getChecked:function(c){var a=[];c=c||"id";for(var b in this.nodeHash){var d=this.nodeHash[b];if(d.checked==1){var e=d.attributes[c];if(e!=null){a.push(e)}}}return a},addListener:function(b,a){if(Function.isInstance(b)){a=b;b==="click"}this.clickListeners.push(a)},setFocusNode:function(a){if(this.focusNode){this.focusNode.unselect()}this.focusNode=a;if(a.parentNode){a.parentNode.expand()}a.select()},toString:function(){return"[Tree"+(this.id?" "+this.id:"")+"]"},collapseAll:function(){if(this.root){this.root.collapseChildNodes(true)}},expandAll:function(){if(this.root){this.root.expand(true)}}};TreePanel.prototype.icon={root:"root.gif",folder:"folder.gif",folderOpen:"folderopen.gif",node:"page.gif",empty:"empty.gif",line:"line.gif",join:"join.gif",joinBottom:"joinbottom.gif",plus:"plus.gif",plusBottom:"plusbottom.gif",minus:"minus.gif",minusBottom:"minusbottom.gif",nlPlus:"nolines_plus.gif",nlMinus:"nolines_minus.gif",checkbox0:"checkbox_0.gif",checkbox1:"checkbox_1.gif",checkbox2:"checkbox_2.gif",org:"org.gif",edp:"edp.gif",emp:"emp.gif"};TreeNode=function(a){this["attributes"]=a||{};this["html-element"]=false;if(!a.id){a.id=getUniqueID()}this.id=a.id;this.parentNode=null;this.childNodes=[];this.parentNode=null;this.lastChild=null;this.firstChild=null;this.previousSibling=null;this.nextSibling=null;this.childrenRendered=false;this.isExpand=false;this.checked=this["attributes"]["checked"];this.checked=this.checked==null?false:this.checked;this.leaf=this.attributes.leaf;var b=a.children||[];for(var c=0,d=b.length;c<d;c++){var e=new TreeNode(b[c]);this.appendChild(e)}};TreeNode.prototype={initEl:function(){this["html-element"]={};this["html-element"]["element"]=document.createElement("div");this["html-element"]["line"]=document.createElement("span");this["html-element"]["clip"]=document.createElement("img");this["html-element"]["text"]=document.createElement("span");this["html-element"]["checkbox"]=document.createElement("img");this["html-element"]["child"]=document.createElement("div");this["html-element"]["element"].appendChild(this["html-element"]["line"]);this["html-element"]["element"].appendChild(this["html-element"]["clip"]);this["html-element"]["element"].appendChild(this["html-element"]["checkbox"]);this["html-element"]["element"].appendChild(this["html-element"]["text"]);this["html-element"]["element"].appendChild(this["html-element"]["child"]);this["html-element"]["text"].className="TreeNode";this["html-element"]["element"].noWrap="true";this["html-element"]["line"]["_type_"]="line";this["html-element"]["clip"]["_type_"]="clip";this["html-element"]["text"]["_type_"]="text";this["html-element"]["checkbox"]["_type_"]="checked";this["html-element"]["child"].style.display="none";if(this.checked===false){this["html-element"]["checkbox"].style.display="none"}},render:function(){if(!this["html-element"]){this.initEl()}if(this.isRoot()){this.ownerTree.element.appendChild(this["html-element"]["element"]);this.expand()}else{this.parentNode["html-element"]["child"].appendChild(this["html-element"]["element"])}this.paintPrefix();this["html-element"]["element"].indexId=this.id},paintPrefix:function(){this.paintLine();this.paintClipIcoImg();this.paintCheckboxImg();this.paintIconImg();this.paintText()},paintLine:function(){var e=this.getOwnerTree();this["html-element"]["line"].innerHTML="";var f=this.getPathNodes();for(var b=1,a=f.length-1;b<a;b++){var d=f[b];var c=document.createElement("img");if(d.isLast()){c.src=e.getIcon("empty")}else{c.src=e.getIcon("line")}this["html-element"]["line"].appendChild(c)}},paintClipIcoImg:function(){if(this.isRoot()){this["html-element"]["clip"].style.display="none";return}var b=this.getOwnerTree();var a="empty";if(this.isRoot()){a=this.isExpand?"nlMinus":"nlPlus"}else{if(this.isLeaf()){if(this.isLast()){a="joinBottom"}else{a="join"}}else{if(this.isExpand){if(this.isLast()){a="minusBottom"}else{a="minus"}}else{if(this.isLast()){a="plusBottom"}else{a="plus"}}}}this["html-element"]["clip"].src=b.getIcon(a)},paintIconImg:function(){return;var b=this.getOwnerTree();var a=this["attributes"]["icon"];if(!a){var c=this["attributes"]["type"];if(c){a=b.getIconByType(c)}if(!a){if(this.isRoot()){a="root"}else{if(this.isLeaf()){a="node"}else{if(this.isExpand){a="folderOpen"}else{a="folder"}}}}}this["html-element"]["icon"].src=b.getIcon(a)},paintCheckboxImg:function(){var b=this.getOwnerTree();var a=this.checked;if(this["html-element"]){this["html-element"]["checkbox"].src=b.getIcon(((a==2)?"checkbox2":(a==1)?"checkbox1":"checkbox0"))}},paintText:function(){var a=this["attributes"]["text"];this["html-element"]["text"].style.cursor="hand";this["html-element"]["text"].title=a;this["html-element"]["text"].innerText=a;this["html-element"]["text"].textContent=a},paintChildren:function(){if(!this.childrenRendered){this["html-element"]["child"].innerHTML="";this.childrenRendered=true;var a=this.childNodes;for(var b=0;b<a.length;b++){a[b].render()}}},collapse:function(a){this.isExpand=false;this["html-element"]["child"].style.display="none";this.paintIconImg();this.paintClipIcoImg();if(a){this.collapseChildNodes(a)}},collapseChildNodes:function(b){var a=this.childNodes;for(var c=0,d=a.length;c<d;c++){a[c].collapse(b)}},expand:function(a){if(!this.isLeaf()&&this.childNodes.length>0){this.isExpand=true;this.paintChildren();this["html-element"]["child"].style.display="block"}this.paintIconImg();this.paintClipIcoImg();if(a){this.expandChildNodes(a)}},expandChildNodes:function(b){var a=this.childNodes;for(var c=0,d=a.length;c<d;c++){a[c].expand(b)}},select:function(){this.isSelect=true;this["html-element"]["text"].style.backgroundColor="#CCCCFF"},unselect:function(){this.isSelect=false;this["html-element"]["text"].style.backgroundColor=""},getEl:function(){return this["html-element"]},setCheck:function(a){if(a==2||a==3){var d=this.childNodes;var e=d.length;if(e==0){this.checked=a==2?0:1}else{var b=0;var c=0;for(var f=0;f<e;f++){var a=d[f].checked;if(a==1){b++}else{if(a==2){c++}}}this.checked=(d.length==b)?1:(b>0||c>0)?2:0}}else{this.checked=a}this.paintCheckboxImg()},onCheck:function(){if(this.checked!==false){if(this.checked==1){this.cascade((function(a){this.setCheck(a)}),null,0);this.bubble((function(a){this.setCheck(a)}),null,2)}else{this.cascade((function(a){this.setCheck(a)}),null,1);this.bubble((function(a){this.setCheck(a)}),null,3)}}},isRoot:function(){return(this.ownerTree!=null)&&(this.ownerTree.root===this)},isLeaf:function(){return this.childNodes.length===0},isLast:function(){return(!this.parentNode?true:this.parentNode.lastChild==this)},isFirst:function(){return(!this.parentNode?true:this.parentNode.firstChild==this)},hasChildNodes:function(){return !this.isLeaf()&&this.childNodes.length>0},setFirstChild:function(a){this.firstChild=a},setLastChild:function(a){this.lastChild=a},appendChild:function(e){var d=false;if(Array.isInstance(e)){d=e}else{if(arguments.length>1){d=arguments}}if(d){for(var a=0,c=d.length;a<c;a++){this.appendChild(d[a])}}else{var f=e.parentNode;if(f){f.removeChild(e)}var b=this.childNodes.length;if(b==0){this.setFirstChild(e)}this.childNodes.push(e);e.parentNode=this;var g=this.childNodes[b-1];if(g){e.previousSibling=g;g.nextSibling=e}else{e.previousSibling=null}e.nextSibling=null;this.setLastChild(e);e.setOwnerTree(this.getOwnerTree());if(e&&this.childrenRendered){e.render();if(e.previousSibling){e.previousSibling.paintPrefix()}}if(this["html-element"]){this.paintPrefix()}return e}},removeChild:function(b){var a=this.childNodes.indexOf(b);if(a==-1){return false}this.childNodes.splice(a,1);var c=b.previousSibling;if(b.previousSibling){b.previousSibling.nextSibling=b.nextSibling}if(b.nextSibling){b.nextSibling.previousSibling=b.previousSibling}if(this.firstChild==b){this.setFirstChild(b.nextSibling)}if(this.lastChild==b){this.setLastChild(b.previousSibling)}b.setOwnerTree(null);b.parentNode=null;b.previousSibling=null;b.nextSibling=null;if(this.childrenRendered){if(b["html-element"]&&b["html-element"]["element"]){this["html-element"]["child"].removeChild(b["html-element"]["element"])}if(this.childNodes.length==0){this.collapse()}}if(this["html-element"]){this.paintPrefix()}if(c){if(c["html-element"]){c.paintPrefix()}c.cascade((function(){if(this["html-element"]){this.paintPrefix()}}))}return b},insertBefore:function(b,f){if(!f){return this.appendChild(b)}if(b==f){return false}var a=this.childNodes.indexOf(f);var c=b.parentNode;var e=a;if(c==this&&this.childNodes.indexOf(b)<a){e--}if(c){c.removeChild(b)}if(e==0){this.setFirstChild(b)}this.childNodes.splice(e,0,b);b.parentNode=this;var d=this.childNodes[e-1];if(d){b.previousSibling=d;d.nextSibling=b}else{b.previousSibling=null}b.nextSibling=f;f.previousSibling=b;b.setOwnerTree(this.getOwnerTree());return b},replaceChild:function(a,b){this.insertBefore(a,b);this.removeChild(b);return b},indexOf:function(a){return this.childNodes.indexOf(a)},getOwnerTree:function(){if(!this.ownerTree){var a=this;while(a){if(a.ownerTree){this.ownerTree=a.ownerTree;break}a=a.parentNode}}return this.ownerTree},getDepth:function(){var a=0;var b=this;while(b.parentNode){a++;b=b.parentNode}return a},setOwnerTree:function(d){if(d!=this.ownerTree){if(this.ownerTree){this.ownerTree.unregisterNode(this)}this.ownerTree=d;var a=this.childNodes;for(var b=0,c=a.length;b<c;b++){a[b].setOwnerTree(d)}if(d){d.registerNode(this)}}},getPathNodes:function(){var a=[];for(var b=this;b!=null;b=b.parentNode){a.push(b)}return a.reverse()},getPath:function(a){a=a||"id";var d=this.parentNode;var c=[this["attributes"][a]];while(d){c.unshift(d.attributes[a]);d=d.parentNode}var e=this.getOwnerTree().pathSeparator;return e+c.join(e)},bubble:function(b,d,a){var c=this;while(c){if(b.call(d||c,(a==null)?c:a)===false){break}c=c.parentNode}},cascade:function(c,f,a){if(c.call(f||this,(a==null)?this:a)!==false){var b=this.childNodes;for(var d=0,e=b.length;d<e;d++){b[d].cascade(c,f,a)}}},findChild:function(a,e){var b=this.childNodes;for(var c=0,d=b.length;c<d;c++){if(b[c].attributes[a]==e){return b[c]}}return null},findChildBy:function(b,e){var a=this.childNodes;for(var c=0,d=a.length;c<d;c++){if(b.call(e||a[c],a[c])===true){return a[c]}}return null},sort:function(b,f){var a=this.childNodes;var d=a.length;if(d>0){var g=f?function(){b.apply(f,arguments)}:b;a.sort(g);for(var c=0;c<d;c++){var e=a[c];e.previousSibling=a[c-1];e.nextSibling=a[c+1];if(c==0){this.setFirstChild(e)}if(c==d-1){this.setLastChild(e)}}}},contains:function(a){var b=a.parentNode;while(b){if(b==this){return true}b=b.parentNode}return false},toString:function(){return"[Node"+(this.id?" "+this.id:"")+"]"}};